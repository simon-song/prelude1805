%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[a4paper,14pt]{memoir}

%\usepackage[utf8]{inputenc}
\usepackage{fontspec}
%\setmainfont[Ligatures=TeX]{Linux Libertine O}
\setmainfont[Ligatures=TeX]{Minion Pro}
%\setmainfont[Mapping=Tex-text]{GFSPorson.ttf} 
%\setmainfont[Mapping=Tex-text]{Gentium} % good 
%\setmainfont[Mapping=Tex-text]{TeXGyrePagella} % not good
%\setmainfont[Mapping=Tex-text]{GFS Porson} % good
%\setmainfont[Mapping=Tex-text]{FreeMono} % works but not very pretty

%\newfontfamily\gentium{Gentium}  % Greek and English
%\newfontfamily\g{GFS Porson}  % Greek only
%\newfontfamily\g{GFSPorson.ttf}
%\newfontfamily\g{Linux Libertine O}
%\newfontfamily\neohellenic{GFS Neohellenic} % Greek only
%\newfontfamily\e{Linux Libertine O}

% \settrimmedsize{11in}{210mm}{*}
% \setlength{\trimtop}{0pt}
% \setlength{\trimedge}{\stockwidth}
% \addtolength{\trimedge}{-\paperwidth}
% \settypeblocksize{8.25in}{33pc}{*}
% %\setulmargins{4cm}{*}{*}
% \setulmargins{4.8cm}{*}{0.5}
% %\setlrmargins{1.25in}{*}{*}
% %\setlrmarginsandblock{1.5in}{*}{*}
% \setlrmarginsandblock{1.0in}{*}{1.5}
% \setmarginnotes{0pt}{0pt}{\onelineskip}  % changed by Pengcheng, no margin
% \setheadfoot{\onelineskip}{2\onelineskip}
% %\setheaderspaces{*}{2\onelineskip}{*}
% \setheaderspaces{*}{\onelineskip}{*} % changed by Pengcheng
% \addtolength{\textwidth}{60pt}     %  increase text width
% \addtolength{\foremargin}{-60pt}
% \checkandfixthelayout

\setheadfoot{\onelineskip}{2\onelineskip}

%%%%   larger line spacing
\usepackage{setspace}
\linespread{1.2}

\usepackage[plainpages=false;pdfpagelabels,bookmarksnumbered]{hyperref}
\usepackage{verse}
\linenumberfrequency{5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Set \vin which is a short hand of \hspace{\vgap}, default value
%%  of \vgap is 1.5em
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\vgap}{1em}
\setlength{\vrightskip}{-2em} % distance of line number from right margin

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% chapter style VZ23 by Vincent Zoonekynd
%% code adapted from Lars Madsen, Various Chapter Styles
%% for the Memoir Class, pp.44-45
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength\midchapskip{10pt}
\makechapterstyle{VZ23} {
  \renewcommand\chapternamenum{}
  \renewcommand\printchaptername{}
  \renewcommand\chapnumfont{\Huge\bfseries\centering}
  \renewcommand\chaptitlefont{\Huge\scshape\centering}
  \renewcommand\afterchapternum{%
    %\par\nobreak\vskip\midchapskip\hrule\vskip\midchapskip}
    \par\nobreak\vskip\midchapskip\vskip\midchapskip}
  \renewcommand\printchapternonum{%
    \vphantom{\chapnumfont \thechapter}
    %\par\nobreak\vskip\midchapskip\hrule\vskip\midchapskip}
    \par\nobreak\vskip\midchapskip\vskip\midchapskip}
}

\chapterstyle{VZ23}

% page style of Oxford Classical Texts 
\makepagestyle{ocd}
  \makeevenhead{ocd}{\thepage}{The Prelude: 1805 Edition}{}
  \makeoddhead{ocd}{}{\rightmark}{\thepage}  % chapter in center
  \makeevenfoot{ocd}{}{}{}
  \makeoddfoot{ocd}{}{}{}

% set \rightmark to chapter name	
\makepsmarks{ocd}{%
  \nouppercaseheads
  \createmark{chapter}{right}{shownumber}{}{. \ }
}

\setsecnumdepth{chapter}

\makepagestyle{app}
  \makeevenhead{app}{\thepage}{The Two-book Prelude (1798--99)}{}
  %\makeoddhead{app}{}{\rightmark}{\thepage}  % chapter in center
  \makeoddhead{app}{}{\leftmark}{\thepage}  % chapter in center
  \makeevenfoot{app}{}{}{}
  \makeoddfoot{app}{}{}{}

% set \rightmark to chapter name	
\makepsmarks{app}{%
  \nouppercaseheads
  %\createmark{section}{right}{shownumber}{}{. \ }
  \createmark{section}{left}{shownumber}{}{. \ }
}

%%%%%%%%%%%%%%%%%% from Peter Wilson, Some Examples of Title Pages, pp.45-46
% \usepackage[T1]{fontenc}
% \usepackage{lmodern}
% \usepackage{url}
% \usepackage[svgnames]{xcolor}
% \ifpdf
% \usepackage{pdfcolmk}
% \fi
% %% check if using xelatex rather than pdflatex
% \ifxetex
% \usepackage{fontspec}
% \fi
% \usepackage{graphicx}
% %%\usepackage{hyperref}
% %% drawing package
% \usepackage{tikz}
% %% for dingbats
% \usepackage{pifont}
% \providecommand{\HUGE}{\Huge}% if not using memoir
% \newlength{\drop}% for my convenience
% %% specify the Webomints family
% % \newcommand*{\wb}[1]{\fontsize{#1}{#2}\usefont{U}{webo}{xl}{n}}
% %% select a (FontSite) font by its font family ID
% \newcommand*{\FSfont}[1]{\fontencoding{T1}\fontfamily{#1}\selectfont}
% %% if you don¡¯t have the FontSite fonts either \renewcommand*{\FSfont}[1]{}
% %% or use your own choice of family.
% %% select a (TeX Font) font by its font family ID
% \newcommand*{\TXfont}[1]{\fontencoding{T1}\fontfamily{#1}\selectfont}
% %% Generic publisher¡¯s logo
% \newcommand*{\plogo}{\fbox{$\mathcal{PL}$}}
% %% some shades
% % \defincolor{Dark}{gray}{0.2}
% % \defincolor{MedDark}{gray}{0.4}
% % \defincolor{Medium}{gray}{0.6}
% % \defincolor{Light}{gray}{0.8}
% %%%% Additional font series macros
% \makeatletter
% %%%% light series
% %% e.g., kernel doc, section s: line 12 or thereabouts
% \DeclareRobustCommand\ltseries
% {\not@math@alphabet\ltseries\relax
% \fontseries\ltdefault\selectfont}
% %% e.g., kernel doc, section t: line 32 or thereabouts
% \newcommand{\ltdefault}{l}
% %% e.g., kernel doc, section v: line 19 or thereabouts
% \DeclareTextFontCommand{\textlt}{\ltseries}
% % heavy(bold) series
% \DeclareRobustCommand\hbseries
% {\not@math@alphabet\hbseries\relax
% \fontseries\hbdefault\selectfont}
% \newcommand{\hbdefault}{hb}
% \DeclareTextFontCommand{\texthb}{\hbseries}
% \makeatother
% %%%%%%%%%%%%%%%%%% end of code from Peter Wilson, Some Examples of Title Pages
% 
% %% adapted from Peter Wilson, Some Examples of Title Pages, p.49
% \newcommand*{\titleRF}{\begingroup % Robert Frost, T&H p 149
% \FSfont{5bp} % FontSite Bergamo (Bembo)
% \drop = 0.2\textheight
% \centering
% \vfill
% {\Huge The Prelude}\\[\baselineskip]
% {\Huge 1805 Edition}\\[\baselineskip]
% {\large by William Wordsworth}\\[0.5\drop]
% {\Large \plogo}\\[0.5\baselineskip]
% {\Large The Publisher}\par
% {\large\scshape year}\par
% \vfill\null
% \endgroup}
% 
% %% adapted from Peter Wilson, Some Examples of Title Pages, p.52
% \newcommand*{\titleP}{\begingroup% The Pyramids, AW p. 81
% \FSfont{5bo} % FontSite Bergamo (Bembo)
% \drop = 0.12\textheight
% \vspace*{\drop}
% \hspace*{0.3\textwidth}
% {\Huge The Prelude}\\[\baselineskip]
% \hspace*{0.3\textwidth}
% {\Huge 1805 Edition}\par
% \vspace*{3\drop}
% {\large By William Wordsworth}
% \vfill
% {\scshape the publisher}
% \vspace*{0.5\drop}
% \endgroup}


%%%%%%%%%%%%%%%%%%%%%%%%
%\usepackage{makeidx}
%\makeindex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%
\frontmatter
\pagestyle{empty}
\begin{center}
  \vspace{2.5in} 
  %\HUGE{The Prelude: 1805 Edition} \par \vspace{3in}
  \resizebox{0.75\linewidth}{!}{The Prelude: 1805 Edition} \par \vspace{0.5in}
  \large{with} \par \vspace{0.5in}
  \Large{The Two-Book Prelude (1798--99)} \par \vspace{3in}
  \large{by} \par \vspace{0.5in}
  \Large{William Wordsworth} 
\end{center}

%\titleP
%\titleRF

\cleardoublepage
\pagenumbering{roman}
\pagestyle{headings}

\tableofcontents*

%%%%%%%%%%%%%%%%%%%%
\mainmatter
\pagestyle{ocd}
\include{text/book01}
\include{text/book02}

\appendix
\pagestyle{app}
\include{text/twobook}

%%%%%%%%%%%%%%%%%%%%
\backmatter
%\printindex
\cleardoublepage
\pagestyle{empty}
\null\vfil

\begin{adjustwidth}{1in}{1in}
\begin{center}
{\Large\textsf{Colophon}}
\end{center}
\begin{center}
  {This document was typeset using the xeTeX typesetting system
  and the memoir class. The body text is set to 14pt on a
  33pc measure with Adobe Minion Pro. The text was taken from 
  (\url{https://sms.cam.ac.uk/collection/1170406}) and
  (\url{https://andromeda.rutgers.edu/~jlynch/Texts/prelude.html}).
  }
\end{center}
\end{adjustwidth}
%\addcontentsline{toc}{chapter}{Colophon}  % add Colophon to ToC

\vfil	

\end{document}
